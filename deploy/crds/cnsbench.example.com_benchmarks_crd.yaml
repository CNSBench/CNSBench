apiVersion: apiextensions.k8s.io/v1
kind: CustomResourceDefinition
metadata:
  name: benchmarks.cnsbench.example.com
spec:
  group: cnsbench.example.com
  names:
    kind: Benchmark
    listKind: BenchmarkList
    plural: benchmarks
    singular: benchmark
  scope: Namespaced
  versions:
  - name: v1alpha1
    schema:
      openAPIV3Schema:
        description: Benchmark is the Schema for the benchmarks API
        properties:
          apiVersion:
            description: 'APIVersion defines the versioned schema of this representation
              of an object. Servers should convert recognized schemas to the latest
              internal value, and may reject unrecognized values. More info: https://git.k8s.io/community/contributors/devel/sig-architecture/api-conventions.md#resources'
            type: string
          kind:
            description: 'Kind is a string value representing the REST resource this
              object represents. Servers may infer this from the endpoint the client
              submits requests to. Cannot be updated. In CamelCase. More info: https://git.k8s.io/community/contributors/devel/sig-architecture/api-conventions.md#types-kinds'
            type: string
          metadata:
            type: object
          spec:
            description: BenchmarkSpec defines the desired state of Benchmark
            properties:
              actions:
                items:
                  properties:
                    createObjSpec:
                      properties:
                        config:
                          nullable: true
                          type: string
                        count:
                          nullable: true
                          type: integer
                        sameVolume:
                          nullable: true
                          type: boolean
                        storageClass:
                          nullable: true
                          type: string
                        syncStart:
                          nullable: true
                          type: boolean
                        volName:
                          nullable: true
                          type: string
                        workload:
                          type: string
                      required:
                      - workload
                      type: object
                    deleteSpec:
                      properties:
                        selector:
                          description: ObjName string `json:"objName"`
                          properties:
                            matchExpressions:
                              description: matchExpressions is a list of label selector
                                requirements. The requirements are ANDed.
                              items:
                                description: A label selector requirement is a selector
                                  that contains values, a key, and an operator that
                                  relates the key and values.
                                properties:
                                  key:
                                    description: key is the label key that the selector
                                      applies to.
                                    type: string
                                  operator:
                                    description: operator represents a key's relationship
                                      to a set of values. Valid operators are In,
                                      NotIn, Exists and DoesNotExist.
                                    type: string
                                  values:
                                    description: values is an array of string values.
                                      If the operator is In or NotIn, the values array
                                      must be non-empty. If the operator is Exists
                                      or DoesNotExist, the values array must be empty.
                                      This array is replaced during a strategic merge
                                      patch.
                                    items:
                                      type: string
                                    type: array
                                required:
                                - key
                                - operator
                                type: object
                              type: array
                            matchLabels:
                              additionalProperties:
                                type: string
                              description: matchLabels is a map of {key,value} pairs.
                                A single {key,value} in the matchLabels map is equivalent
                                to an element of matchExpressions, whose key field
                                is "key", the operator is "In", and the values array
                                contains only "value". The requirements are ANDed.
                              type: object
                          type: object
                      required:
                      - selector
                      type: object
                    name:
                      type: string
                    outputs:
                      properties:
                        files:
                          items:
                            properties:
                              label:
                                type: string
                              parser:
                                type: string
                              path:
                                type: string
                            required:
                            - path
                            type: object
                          type: array
                        outputName:
                          type: string
                      required:
                      - outputName
                      type: object
                    rateName:
                      nullable: true
                      type: string
                    scaleSpec:
                      description: 'TODO: need a way of specifying how to scale -
                        up or down, and by how much'
                      properties:
                        objKind:
                          type: string
                        objName:
                          type: string
                      required:
                      - objKind
                      - objName
                      type: object
                    snapshotSpec:
                      description: Snapshots and deletions can operate on an individual
                        object or a selector if a selector, then there may be multiple
                        objects that match - should specify different policies for
                        deciding which object to delete, e.g. "newest", "oldest",
                        "random", ???
                      properties:
                        snapshotClass:
                          type: string
                        volName:
                          type: string
                      required:
                      - snapshotClass
                      - volName
                      type: object
                  required:
                  - name
                  type: object
                type: array
              outputs:
                items:
                  properties:
                    httpPostSpec:
                      properties:
                        url:
                          type: string
                      required:
                      - url
                      type: object
                    name:
                      type: string
                  required:
                  - name
                  type: object
                type: array
              rates:
                items:
                  properties:
                    constantIncreaseDecreaseRateSpec:
                      properties:
                        decInterval:
                          type: integer
                        incInterval:
                          type: integer
                        max:
                          type: integer
                        min:
                          type: integer
                      required:
                      - decInterval
                      - incInterval
                      - max
                      - min
                      type: object
                    constantRateSpec:
                      properties:
                        interval:
                          type: integer
                      required:
                      - interval
                      type: object
                    name:
                      type: string
                  required:
                  - name
                  type: object
                nullable: true
                type: array
              runtime:
                type: string
            type: object
          status:
            description: BenchmarkStatus defines the observed state of Benchmark
            properties:
              completionTime:
                format: date-time
                nullable: true
                type: string
              completionTimeUnix:
                format: int64
                type: integer
              conditions:
                items:
                  properties:
                    lastProbeTime:
                      format: date-time
                      nullable: true
                      type: string
                    lastTransitionTime:
                      format: date-time
                      type: string
                    message:
                      nullable: true
                      type: string
                    reason:
                      nullable: true
                      type: string
                    status:
                      type: string
                    type:
                      type: string
                  required:
                  - lastTransitionTime
                  - status
                  - type
                  type: object
                type: array
              initCompletionTime:
                format: date-time
                nullable: true
                type: string
              initCompletionTimeUnix:
                format: int64
                type: integer
              numCompletedObjs:
                type: integer
              runningActions:
                description: This doesn't include RuneOnce actions
                type: integer
              runningRates:
                type: integer
              startTimeUnix:
                format: int64
                type: integer
              state:
                type: string
            required:
            - completionTimeUnix
            - conditions
            - initCompletionTimeUnix
            - numCompletedObjs
            - runningActions
            - runningRates
            - startTimeUnix
            - state
            type: object
        type: object
    served: true
    storage: true
    subresources:
      status: {}
